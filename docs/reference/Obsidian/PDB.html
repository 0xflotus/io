<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
		<html>
		<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
		<title>PDB</title>
		<META HTTP-EQUIV="EXPIRES" CONTENT=0>
		<link rel="stylesheet" href="../../docs.css">
		</head>
		<body>
		
<br>
<h1>PDB Proto</h1>
<br><br><br><br><br><br>
<table border=0 cellspacing=0 style="margin-left:8em; width:45em; line-height:1.2em;">
<tr>
<td align=right></td>
<td></td>
<td>An arbitrary graph database with support for on-disk garbage collection. Example use:

<h4>Setup</h4>

<pre>
PDB open
PDB root atPut("users", PMap clone)
PDB sync
PDB close
</pre>

PMap is a Map/Dictionary whose keys are lazily loaded from the database. 
PDB root is the root PMap in the database and the root object used for PDB's garbage collector. 
PDB sync needs to be called to write any changes to the database.

<h4>Defining a Persistent Object</h4>

<pre>
User := Object clone pSlots(name, email)
</pre>

The pSlots(), declares which slots on the object should be persisted. 
The List, Date, Sequence and Number primitives already know how to persist themselves.

<h4>Inserting a Persistent Object</h4>

<pre>
PDB open 
user := User clone setName("steve") setEmail("steve@foo.com")
PDB root users atPut("steve", user)
PDB sync
PDB close
</pre>

<h4>Accessing a Persistent Object</h4>

<pre>
user := PDB root users at("steve")
writeln("user name = ", user name, " email = ", user email)
</pre>

<h4>Updating a Persistent Object</h4>

<pre>
user setEmail("steve@newDomain.com")
PDB sync 
</pre>

PDB sync will scan all persistent objects in the vm and save any with changes to their persistent slots. 
If the object was already in the database, only it's updated slots will be written.

<h4>Removing an entry in a PMap</h4>

<pre>
PDB root users removeAt("steve")
</pre>

<h4>Removing a persistent object</h4>

This is never done explicitly, instead calling:

<pre>
PDB collectGarbage
</pre>

Will remove all objects unreachable by the reference graph from the root PMap.

<p>
Notes: Currently, PDB is a singleton.
</td></tr>
<tr><td colspan=3>&nbsp;</td></tr>
<tr><td colspan=3>&nbsp;</td></tr>
<tr><td colspan=3>&nbsp;</td></tr>
<tr>
<td align=right>
</td>
<td></td>
<td>
<a name="PDB-Lobby"></a><b>
Lobby
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-Protos"></a><b>
Protos
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-addonFolders"></a><b>
addonFolders
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-cat"></a><b>
cat
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-catName"></a><b>
catName
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-categories"></a><b>
categories
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-count"></a><b>
count
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-docsPath"></a><b>
docsPath
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-exit"></a><b>
exit
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-f"></a><b>
f
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-firstProto"></a><b>
firstProto
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-firstProtoName"></a><b>
firstProtoName
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-folder"></a><b>
folder
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-forward"></a><b>
forward
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-isDeprecated"></a><b>
isDeprecated
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-isPrivate"></a><b>
isPrivate
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-k"></a><b>
k
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-module"></a><b>
module
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-moduleName"></a><b>
moduleName
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-moduleNames"></a><b>
moduleNames
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-moduleProtoNames"></a><b>
moduleProtoNames
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-modules"></a><b>
modules
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-outFile"></a><b>
outFile
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-p"></a><b>
p
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-protoName"></a><b>
protoName
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-protoNames"></a><b>
protoNames
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-prototypes"></a><b>
prototypes
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-readFolder"></a><b>
readFolder
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-s"></a><b>
s
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-showMeta"></a><b>
showMeta
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-showSection"></a><b>
showSection
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-showSpacer"></a><b>
showSpacer
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-slots"></a><b>
slots
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
<a name="PDB-totalCount"></a><b>
totalCount
</b>
<p>
<div class=slotDescription>
<div class=error>undocumented</div>
</div>
</td>
</tr>
</table>
<br><br><br><br><br>
